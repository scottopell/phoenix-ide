# Patch Tool - Executive Summary

## Requirements Summary

The patch tool enables precise file editing through four operations: replace (substitute unique text), append_eof, prepend_bof, and overwrite (creates files). Replace operations require oldText to match exactly once, preventing ambiguous edits. Multiple patches per call are applied atomically against original content—if any fails, the file remains unchanged. Clipboards enable cut/copy/paste workflows that persist across calls, reducing transcription errors when moving code. Reindentation adjusts whitespace when moving code between indentation levels. Fuzzy matching recovers from minor whitespace differences in LLM-generated patches. Autogenerated files trigger warnings but patches apply anyway.

## Technical Summary

Implemented as a Tool trait with schema for path and patches array. Each patch specifies operation, optional oldText/newText, optional clipboard names, and optional reindent config. EditBuffer tracks all edits against original content for atomic application. Fuzzy matching tries: exact match, dedent adjustment, Go token normalization, line trimming. Clipboards stored in HashMap on PatchTool struct, persisting within conversation. Reindentation strips then adds prefixes line-by-line, failing if strip prefix not present. Unified diff generated for UI display.

## Status Summary

| Requirement | Status | Notes |
|-------------|--------|-------|
| **REQ-PATCH-001:** File Operations | ❌ Not Started | Four operation types |
| **REQ-PATCH-002:** Multiple Patches Per Call | ❌ Not Started | Atomic EditBuffer |
| **REQ-PATCH-003:** Clipboard Operations | ❌ Not Started | Cut/copy/paste workflows |
| **REQ-PATCH-004:** Indentation Adjustment | ❌ Not Started | Strip/add prefixes |
| **REQ-PATCH-005:** Fuzzy Matching Recovery | ❌ Not Started | Whitespace normalization |
| **REQ-PATCH-006:** Tool Schema | ❌ Not Started | Schema definition |
| **REQ-PATCH-007:** Output and Display | ❌ Not Started | Diff generation, warnings |
| **REQ-PATCH-008:** Size Limits | ❌ Not Started | 60k token limit |

**Progress:** 0 of 8 complete
